{"version":3,"sources":["main.js"],"names":[],"mappings":"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","file":"main-compiled.js","sourcesContent":["\n// this is the datetime format for all the datetimepickers on the page\nvar datetimeFormat = 'YYYY-MM-DD HH:mm'; // HH:mm\n\njQuery(function ($) {\n    var timepickerSettings = {\n            template: false,\n            showInputs: false,\n            maxHours: 24,\n            minuteStep: 5,\n            default: '00:00',\n            showSeconds: false,\n            showMeridian: false,\n            explicitMode: true\n        },\n        $datetimepickers = [],\n        timepickerOpts = {sideBySide: true, showMeridian: false, defaultTime: '8:00'};\n\n    $datetimepickers._0 = $('#day-1').datetimepicker({format: datetimeFormat});\n    $datetimepickers._0.datetimepicker('options', timepickerOpts);\n\n    $datetimepickers.pushDate = $('#push-date').datetimepicker({format: datetimeFormat});\n    $datetimepickers.pushDate.datetimepicker('options', timepickerOpts);\n\n    let i = 2;\n    let $nextDynamicDatePicker = $(`input[name=\"day-${i++}\"]`);\n    while ($nextDynamicDatePicker.length) {\n        $nextDynamicDatePicker\n            .datetimepicker({format: datetimeFormat});\n        $nextDynamicDatePicker\n            .datetimepicker('options', timepickerOpts);\n\n        $nextDynamicDatePicker = $(`#day-${i++}`);\n    }\n\n    // All the tooltips\n    $('[data-toggle=\"tooltip\"]').tooltip();\n    $('[data-toggle=\"popover\"]').popover();\n\n\n\n\n    var $getDatesBtn = $('#get-dates-by-event');\n    $getDatesBtn.on('click', (evt) => {\n        let eventID = + ($('#dates-event-id').val());\n        $.ajax({\n            url: 'ajax.php',\n            type: 'post',\n            data: {\n                'event-id': eventID\n            },\n            dataType: 'json',\n            complete(resp) {\n                if (resp.hasOwnProperty('responseJSON') && typeof resp.responseJSON === \"object\" && !!resp.responseJSON.hasOwnProperty('data')) {\n                    if (resp.responseJSON.success) {\n                        let data = resp.responseJSON.data;\n\n                        if (typeof data.dates === \"object\" && data.dates.constructor === Array) {\n                            let $dynamicDates = $('#dynamic-dates');\n                            $dynamicDates.html('');\n\n                            data.dates.forEach((dateTime, ind)=> {\n                                if (/.*\\s\\d{2}:\\d{2}:.*/.test(dateTime)) {\n                                    dateTime = /(.*\\s\\d{2}:\\d{2}):.*/.exec(dateTime)[1];\n\n                                }\n                                if ($dynamicDates.find(`input[name=day-${ind+1}]`).length) {\n                                    // There is already an element for this datetimepicker to take over\n                                    // Set the date onto the datetimepicker (using .data(\"DateTimePicker\").FUNCTION() )\n                                    $dynamicDates.find(`input[name=day-${ind+1}]`).datetimepicker({date: dateTime});\n                                }\n                                else {\n                                    let breaks = typeof data.breaks === \"object\" && data.breaks.constructor === Array && data.breaks.length > ind ? data.breaks[ind] :'';\n                                    // remove trailing commas\n                                    breaks = breaks.replace(/(.*\\d),+$/, '$1');\n\n                                    // There is no datetimepicker element so we must add one.\n                                    let nextDateTimePicker = `\n                    <div class='form-group col-md-6 col-lg-4'>\n                        <div class='form-group calendar-form-group'>\n                            <label for='day-1' style='height:4rem;'>Day ${ind + 1}:</label>\n                            <div class='input-group date' id='day-${ind + 1}'>\n                                <input type='text' class='form-control' name='day-${ind + 1}' value=\"${dateTime}\" />\n                                <span class='input-group-addon'>\n                                    <span class='glyphicon glyphicon-calendar'></span>\n                                </span>\n                            </div>\n                        </div>\n                        Breaks:<br><input type='text' value='${breaks}' name='breaks-day-${ind + 1}' class='input form-control'>\n                    </div>`;\n                                    // Add this date to the page and then update the date inside of it.\n                                    $dynamicDates.append(nextDateTimePicker);\n                                    $(`#day-${ind + 2}`)\n                                        .datetimepicker({format: datetimeFormat, date: dateTime});\n                                    $(`#day-${ind + 2}`)\n                                        .datetimepicker('options', timepickerOpts);\n\n                                }\n                                \n                            });\n\n                            let numDatepickers = data.dates.length + 1;\n                            while ( $(`#day-${numDatepickers++}`).length ) {\n                                $(`#day-${numDatepickers++}`).parents('.form-group').first().remove();\n                            }\n\n                            if (typeof data.conflicts === \"object\") {\n                                // Get the emails and their conflicts\n                                $('input[name=\"conflicts\"]').val(JSON.stringify(data.conflicts));\n                                $('input[name=\"conflicts\"]').parents('form').first().append('<input name=\"conflicts-from-javascript\" type=\"hidden\" value=\"1\" />');\n\n                                let conflictsForm = \"<div class='row panel'><div class='panel panel-heading'>Watching for conflicts:</div><div class='panel panel-body'>\";\n                                for (let email in data.conflicts) {\n                                    if (data.conflicts.hasOwnProperty(email)){\n                                        conflictsForm += `<strong>${email}</strong> @ <code>${data.conflicts[email].from}</code> - <code>${data.conflicts[email].to}</code><br>`;\n                                    }\n                                }\n                                conflictsForm += \"</div></div>\";\n\n                                $('.conflicts-group').html(conflictsForm);\n                            }\n                        }\n                    } else {\n                        console.error('fail', resp.responseJSON);\n                    }\n                }\n            }\n        });\n\n        evt.preventDefault();\n    });\n\n\n\n\n    function setupAllTimePickers() {\n        $('.break-timepicker').timepicker(timepickerSettings)\n            .on('changeTime.timepicker', function() {\n                var $tc = $(this);\n                if ($tc.attr('name').match(/break-start/)) {\n                    // Make sure end is after start\n                    var $end = $tc.parent().next('label[for=\"break-end[]\"]').find('input');\n                    if (+$end.val().replace(/[^0-9]/, '') < +$tc.val().replace(/[^0-9]/, '')) {\n                        // the end time must be equal or greater than start\n                        $end.timepicker('setTime', $tc.val());\n                    }\n                }\n                else if ($tc.attr('name').match(/break-end/)) {\n                    // Make sure start doesn't come after end\n                    var $start = $tc.parent().prev('label[for=\"break-start[]\"]').find('input');\n                    if (+$start.val().replace(/[^0-9]/, '') > +$tc.val().replace(/[^0-9]/, '')) {\n                        // the end time must be equal or greater than start\n                        $start.timepicker('setTime', $tc.val());\n                    }\n                }\n            });\n    }\n\n\n    setupAllTimePickers();\n    $('.add-new-break').on('click', function () {\n        var $btn = $(this);\n        var $newBreakInput = $btn.prev('.new-break-input-container');\n        if ($btn.length && $newBreakInput.length) {\n\n\n            if ($newBreakInput.hasClass('hidden')) {\n                $newBreakInput.removeClass('hidden');\n            } else {\n                $btn.before($newBreakInput.clone());\n            }\n            setupAllTimePickers();\n        }\n    });\n\n    window.devbug = () => {\n        let hiddenInput = $('input[type=hidden][name=devbug]');\n        if (hiddenInput.length) {\n            // toggle the inputs value\n            return hiddenInput.val(!hiddenInput.val());\n        }\n        $('form[name=config]').append('<input type=\"hidden\" name=\"devbug\" value=\"true\">');\n    };\n});\n\n"]}